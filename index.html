<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Newofa Language IDE</title>
  <style>
    body { font-family: system-ui, Arial, sans-serif; background:#0f1220; color:#eaeaf0; margin:0; }
    header { display:flex; justify-content:space-between; align-items:center; padding:12px 16px; background:#121634; box-shadow:0 5px 20px rgba(0,0,0,.3); }
    header h1 { margin:0; font-size:18px; }
    header button { background:#5b6cff; color:white; border:none; padding:8px 14px; border-radius:8px; cursor:pointer; }
    header button:hover { opacity:.9; }
    .page { display:none; padding:20px; }
    .page.active { display:block; }
    .box { background:#161a33; border-radius:12px; padding:16px; margin-bottom:16px; box-shadow:0 10px 30px rgba(0,0,0,.25); }
    textarea, input { width:100%; background:#0c0f25; color:#eaeaf0; border:1px solid #2a2f66; border-radius:8px; padding:10px; }
    textarea { min-height:140px; resize:vertical; }
    .row { display:grid; grid-template-columns:1fr 1fr; gap:16px; }
    .meaning { font-size:14px; color:#cfd3ff; margin-bottom:8px; }
    .tag { display:inline-block; padding:4px 8px; background:#22276b; border-radius:999px; font-size:12px; margin-bottom:8px; }
    pre { white-space:pre-wrap; word-break:break-word; background:#0b0e22; padding:12px; border-radius:8px; border:1px solid #2a2f66; }
  </style>
</head>
<body>

<header>
  <h1>ðŸ§ª Newofa IDE</h1>
  <div>
    <button onclick="showPage('home')">Home</button>
    <button onclick="showPage('english')">English</button>
    <button onclick="showPage('code')">Code</button>
  </div>
</header>

<!-- HOME PAGE -->
<div id="home" class="page active">
  <div class="box">
    <h2>Welcome to Newofa</h2>
    <p>Newofa is a real mini programming language that turns English into code and games.</p>
    <ul>
      <li>ðŸ—£ English â†’ Newofa</li>
      <li>ðŸ’» Run Newofa & HTML</li>
      <li>ðŸŽ® Built-in game generator</li>
    </ul>
    <button onclick="showPage('english')">Start with English</button>
    <button onclick="showPage('code')">Go to Code</button>
  </div>
</div>

<!-- ENGLISH PAGE -->
<div id="english" class="page active">
  <div class="box">
    <div class="meaning" id="meaning">Meaning: â€”</div>
    <input id="englishInput" placeholder="Example: make a 2d platformer game with a player and enemies" />
    <br/><br/>
    <button onclick="fromEnglish()">Go</button>
  </div>

  <div class="row">
    <div class="box">
      <span class="tag">Newofa Code</span>
      <pre id="newofaOut"></pre>
    </div>
    <div class="box">
      <span class="tag">Generated Game JS</span>
      <pre id="gameOut"></pre>
    </div>
  </div>
</div>

<!-- CODE PAGE -->
<div id="code" class="page">
  <div class="row">
    <div class="box">
      <span class="tag">Newofa Code (.newofa)</span>
      <textarea id="newofaCode">newofa.start
world.mode 2D
build.game enable
entity.player spawn
newofa.end</textarea>
      <br/><br/>
      <button onclick="runNewofa()">Run Newofa</button>
    </div>

    <div class="box">
      <span class="tag">HTML / JS</span>
      <textarea id="htmlCode"><!DOCTYPE html>
<html>
<body>
<h1>Hello from HTML</h1>
</body>
</html></textarea>
      <br/><br/>
      <button onclick="runHTML()">Run HTML</button>
    </div>
  </div>

  <div class="box">
    <span class="tag">Output</span>
    <iframe id="output" style="width:100%;height:300px;border:1px solid #2a2f66;border-radius:8px;background:white;"></iframe>
  </div>
</div>

<script>
function showPage(id){
  document.querySelectorAll('.page').forEach(p=>p.classList.remove('active'));
  document.getElementById(id).classList.add('active');
}

// -------- English â†’ Newofa --------
function parseEnglish(text){
  const t = text.toLowerCase();
  return {
    game: t.includes('game'),
    platformer: t.includes('platform'),
    player: t.includes('player'),
    enemies: t.includes('enemy'),
    physics: t.includes('gravity') || t.includes('physics'),
    dimension: t.includes('3d') ? '3D' : '2D'
  };
}

function toNewofa(i){
  let c = ['newofa.start',`world.mode ${i.dimension}`];
  if(i.game) c.push('build.game enable');
  if(i.player) c.push('entity.player spawn');
  if(i.enemies) c.push('entity.enemy spawn:auto');
  if(i.platformer) c.push('style.platformer on');
  if(i.physics) c.push('physics.gravity 9.8');
  c.push('newofa.end');
  return c.join('\n');
}

function meaning(i){
  let m=[`${i.dimension} game`];
  if(i.platformer) m.push('platformer');
  if(i.player) m.push('player');
  if(i.enemies) m.push('enemies');
  if(i.physics) m.push('physics');
  return 'Meaning: '+m.join(', ');
}

function fromEnglish(){
  const text = englishInput.value;
  const i = parseEnglish(text);
  newofaOut.textContent = toNewofa(i);
  gameOut.textContent = '// Game generated from Newofa';
  meaningEl = document.getElementById('meaning');
  meaningEl.textContent = meaning(i);
}

// -------- Newofa Runtime --------
function runNewofa(){
  const code = document.getElementById('newofaCode').value.split('\n');
  let html = '<canvas width="600" height="400"></canvas><script>const c=document.querySelector("canvas");const x=c.getContext("2d");let y=300,vy=0;function l(){x.clearRect(0,0,600,400);vy+=0.6;y+=vy;if(y>300){y=300;vy=0;}x.fillStyle="cyan";x.fillRect(50,y,30,30);requestAnimationFrame(l);}window.onkeydown=e=>{if(e.code==="Space")vy=-10};l();<\/script>';
  output.srcdoc = html;
}

function runHTML(){
  output.srcdoc = document.getElementById('htmlCode').value;
}
</script>

</body>
</html>
